<!DOCTYPE html>
<html xmlns:c="http://www.concordion.org/2007/concordion" lang="en">
<head>
    <meta charset="UTF-8"/>
    <link href="../../../concordion.css" rel="stylesheet" type="text/css" />
    <title>Sofort端berweisung Charge w/o Separate Authorization</title>
</head>
<body>
<h1>Charge via Sofort端berweisung without separate Authorization </h1>
<p>
    The integration service allows to capture money from a <a href="https://www.sofort.com">Sofort端berweisung</a> account in a
    one step process without initiating a separate authorization before.
</p>
<p>
    It will do so by sending an <em c:set="#requestType">authorization</em> request to the PAYONE platform.
    <br/>
    It will store information about such a request as an interface interaction of type
    <em>PAYONE_INTERACTION_REQUEST</em>.
</p>
<h3>Common Setup</h3>
<ul>
    <li>payment.paymentMethodInfo.method: <span c:set="#paymentMethod">BANK_TRANSFER-SOFORTUEBERWEISUNG</span></li>
    <li>payment.transactions[0].type: <span c:set="#transactionType">CHARGE</span></li>
</ul>
<div class="example">
    <h3>Charge immediately</h3>
    <p>
        Given the following payments for
        <em>a Sofort端berweisung account that does <b>not</b> support charges for currencies other than EUR</em>:
    </p>
    <table>
        <tr>
            <th c:set="#paymentName">Payment Name</th>
            <th c:set="#centAmount">Cent Amount</th>
            <th c:set="#currencyCode">Currency Code</th>
            <th c:echo="#paymentId">Payment ID (for information only)</th>
        </tr>
        <tr>
            <td>Payment 1</td>
            <td>406</td>
            <td>EUR</td>
            <td></td>
        </tr>
        <tr>
            <td>Payment 2</td>
            <td>91341</td>
            <td>USD</td>
            <td></td>
        </tr>
    </table>
    <p>
        Due to difficulties during testing, unfortunately we can not provide an automated test here. The test was carried out
        manually with the result, that Payment 2 was denied as expected. Payment 1 received the redirect url successfully, but
        when following the url and acknowledging the payment, we unexpectedly received an <b>appointed/completed</b> notification with
        <b>sequencenumber 1</b>. The Charge transaction can not be matched because it was processed with sequencenumber 0. This
        is not a behavior expected from the docs by PAYONE and is also related to the issue for PAYPAL ChargeImmediately.
    </p>
    <p>
        You can see both examples in the commercetools platform:
        Payment 1 - 9f0a9d65-5200-4aeb-8e4c-d97282250667
        Payment 2 - adf0ea2d-922f-482b-b36a-e9fb246cee6a
    </p>
    <p>
        See <a href="https://github.com/commercetools/commercetools-payone-integration/issues/68">issue #68</a>.
    </p>
</div>
</body>
</html>
